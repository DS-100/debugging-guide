<script>
    document.addEventListener("DOMContentLoaded", function() {
    // 1. Select the specific parent div within the callout header that has the 
    //    collapse attributes (data-bs-toggle).
    var calloutToggles = document.querySelectorAll(
        '.callout-header[data-bs-toggle="collapse"]'
    );

    calloutToggles.forEach(function(toggle) {
        // 2. Force the ARIA role to be 'button'
        // This is crucial because a 'div' is not allowed to use aria-expanded.
        toggle.setAttribute('role', 'button');
        
        // 3. Ensure it is keyboard-focusable (critical accessibility fix)
        if (toggle.getAttribute('tabindex') === null) {
             toggle.setAttribute('tabindex', '0');
        }
    });

    // 1. Target all code blocks (Source Code and Code Output <pre> elements)
    // that are scrollable (have overflow:auto/scroll).
    var scrollableRegions = document.querySelectorAll(
        // 1. Source Code <pre>
        'div.sourceCode > pre, ' + 
        // 2. Output <pre> inside a generic cell-output
        '.cell-output > pre, ' + 
        // 3. The main DIV container for cell-output-display (from previous fix)
        '.cell-output-display.cell-output, ' +
        // 4. PRE tag inside any ANSI-escaped output (e.g., .ansi-escaped-output > pre)
        '.ansi-escaped-output > pre, ' +
        // 5. The deepest container for error output (e.g., #ID > .cell-output-error... > .ansi-escaped-output > pre)
        '.cell-output-error.cell-output > .ansi-escaped-output > pre, ' +
        // Target any PRE tag that has an ID attribute
        'pre[id], ' + 
        // code blocks inside list items
        'li > pre, ' + 
        // PRE tags within an output display container
        '.cell-output-display > pre'
    );

    scrollableRegions.forEach(function(region) {
        // Check if the element actually has horizontal overflow (is scrollable)
        // Add tabindex="0" to make the region keyboard-focusable.
        if (region.getAttribute('tabindex') === null || region.getAttribute('tabindex') === undefined) {
             region.setAttribute('tabindex', '0');
        }
    });
});
</script>